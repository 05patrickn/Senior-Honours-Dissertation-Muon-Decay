import matplotlib.pyplot as plt
import numpy as np

import datetime

# Lists to store the data
timestamps = []
sum_values = []
std_dev_values = []

# Read the file
with open('preassure_data.txt', 'r') as file:
    for line in file:
        parts = line.strip().split(': ')
        if len(parts) == 2:
            timestamp_str, data_str = parts
            timestamp = datetime.datetime.strptime(timestamp_str, '%Y-%m-%d %H:%M:%S')
            data_parts = data_str.split(', ')
            sum_value = int(data_parts[0].split('=')[1])
            std_dev_value = float(data_parts[1].split('=')[1])
            
            timestamps.append(timestamp)
            sum_values.append(sum_value)
            std_dev_values.append(std_dev_value)
pressure= [1004.55, 1004.6, 1004.46, 1004.37, 1004.41, 1004.31, 1004.22, 1004.28, 1004.21, 1004.11, 1004.09, 1003.97, 1004.05, 1004.03, 1003.93, 1003.93, 1003.75, 1003.89, 1003.88, 1003.96, 1004.0, 1003.99, 1003.98, 1003.92, 1004.0, 1003.98, 1003.93, 1003.91, 1003.87, 1003.84, 1003.87, 1003.83, 1003.87, 1003.84, 1003.68, 1003.44, 1003.4, 1003.64, 1003.48, 1003.34, 1003.19, 1003.07, 1002.95, 1002.9, 1002.67, 1002.46, 1002.29, 1002.18, 1001.86, 1001.8, 1001.84, 1001.63, 1001.59, 1001.55, 1001.29, 1001.27, 1001.11, 1000.99, 1000.73, 1000.59, 1000.59, 1000.53, 1000.4, 1000.27, 1000.17, 1000.13, 999.98, 1000.06, 1000.06, 1000.02, 999.94, 999.97, 999.94, 999.93, 999.86, 999.98, 1000.02, 999.9, 999.95, 999.88, 999.75, 999.71, 999.68, 999.51, 999.39, 999.34, 999.24, 999.0, 999.01, 998.91, 998.97, 998.77, 998.65, 998.55, 998.63, 998.46, 998.5, 998.33, 998.3, 998.42, 998.1, 998.03, 998.01, 997.64, 997.63, 997.47, 997.33, 997.23, 997.06, 997.05, 996.89, 996.81, 997.07, 997.13, 996.85, 996.83, 996.88, 996.96, 996.97, 996.9, 996.83, 996.94, 996.89, 996.98, 996.95, 997.09, 997.23, 997.34, 997.4, 997.39, 997.42, 997.54, 997.57, 997.54, 997.42, 997.33, 997.36, 997.25, 997.41, 997.45, 997.36, 997.62, 997.63, 997.63, 997.55, 997.66, 997.62, 997.54, 997.58, 997.57, 997.63, 997.55, 997.57, 997.56, 997.69, 997.75, 997.6, 997.57, 997.46, 997.42, 997.5, 997.49, 997.56, 997.62, 997.78, 997.92, 998.05, 998.2, 998.3, 998.28, 998.45, 998.51, 998.64, 998.71, 998.76, 998.72, 998.8, 998.66, 998.9, 998.95, 998.86, 998.84, 998.71, 998.8, 998.81, 998.86, 998.87, 998.92, 998.98, 998.91, 998.98, 999.04, 999.0, 999.01, 999.02, 999.01, 998.85, 998.91, 998.87, 998.93, 998.91, 998.89, 998.91, 998.91, 998.93, 998.88, 998.79, 998.7, 998.76, 998.72, 999.01, 999.02, 999.01, 998.97, 999.05, 999.07, 999.13, 999.17, 999.22, 999.36, 999.47, 999.59, 999.7, 999.82, 999.89, 1000.02, 999.97, 1000.06, 1000.11, 1000.12, 1000.17, 1000.19, 1000.17, 1000.04, 1000.0, 1000.03, 1000.04, 1000.07, 999.94, 999.96, 999.99, 999.87, 999.81, 999.79, 999.88, 999.86, 999.73, 999.68, 999.7, 999.69, 999.63, 999.64, 999.57, 999.53, 999.55, 999.53, 999.68, 999.65, 999.79, 999.86, 999.96, 1000.03, 1000.01, 1000.16, 1000.13, 1000.18, 1000.22, 1000.19, 1000.2, 1000.28, 1000.37, 1000.49, 1000.46, 1000.46, 1000.56, 1000.56, 1000.51, 1000.45, 1000.43, 1000.34, 1000.28, 1000.16, 1000.08, 1000.04, 999.96, 999.95, 999.89, 999.85, 999.88, 999.92, 999.97, 999.91, 999.86, 999.79, 999.73, 999.63, 999.65, 999.76, 999.73, 999.66, 999.73, 999.69, 999.7, 999.69, 999.7, 999.69, 999.68, 999.66, 999.72, 999.76, 999.78, 1000.01, 1000.09, 1000.07, 1000.26, 1000.52, 1000.63, 1000.71, 1000.79, 1000.86, 1000.9, 1001.03, 1001.15, 1001.18, 1001.12, 1001.18, 1001.17, 1001.18, 1001.19, 1001.3, 1001.34, 1001.3, 1001.47, 1001.55, 1001.6, 1001.61, 1001.68, 1001.73, 1001.74, 1001.83, 1001.88, 1001.92, 1001.98, 1002.05, 1002.12, 1002.14, 1002.14, 1002.22, 1002.25, 1002.24, 1002.25, 1002.29, 1002.32, 1002.38, 1002.51, 1002.66, 1002.83, 1002.99, 1003.1, 1003.33, 1003.48, 1003.61, 1003.79, 1003.91, 1004.17, 1004.27, 1004.38, 1004.5, 1004.63, 1004.69, 1004.81, 1004.94, 1005.03, 1005.1, 1005.09, 1005.26, 1005.29, 1005.29, 1005.38, 1005.45, 1005.48, 1005.52, 1005.71, 1005.66, 1005.84, 1006.0, 1006.05, 1006.12, 1006.2, 1006.33, 1006.29, 1006.29, 1006.42, 1006.35, 1006.45, 1006.56, 1006.69, 1006.81, 1006.94, 1007.04, 1007.15, 1007.34, 1007.65, 1007.83, 1007.78, 1007.94, 1008.11, 1008.36, 1008.44, 1008.61, 1008.67, 1008.77, 1008.97, 1009.06, 1009.18, 1009.49, 1009.6, 1009.76, 1010.03, 1010.08, 1010.26, 1010.4, 1010.53, 1010.6, 1010.66, 1010.73, 1010.89, 1011.0, 1011.02, 1011.08, 1011.15, 1011.41, 1011.2, 1011.24, 1011.17, 1010.86, 1010.65, 1010.94, 1011.07, 1011.12, 1011.17, 1011.46, 1011.48, 1011.43, 1011.77, 1011.97, 1011.94, 1011.89, 1011.79, 1011.77, 1011.65, 1011.74, 1012.0, 1012.22, 1012.42, 1012.52, 1012.81, 1013.07, 1013.27, 1013.45, 1013.73, 1013.81, 1013.87, 1013.92, 1013.92, 1013.99, 1014.09, 1014.29, 1014.45, 1014.33, 1014.32, 1014.24, 1014.21, 1014.13, 1014.05, 1013.94, 1013.91, 1013.85, 1013.94, 1013.93, 1013.84, 1013.79, 1013.76, 1013.7, 1013.71, 1013.79, 1013.72, 1013.77, 1013.81, 1013.8, 1013.74, 1013.7, 1013.57, 1013.39, 1013.5, 1013.63, 1013.69, 1013.73, 1013.79, 1013.52, 1013.42, 1013.53, 1013.87, 1013.94, 1014.0, 1014.26, 1014.58, 1014.74, 1014.95, 1015.38, 1015.71, 1015.43, 1015.04, 1014.56, 1014.31, 1014.31, 1014.78, 1014.81, 1014.77, 1015.05, 1014.98, 1014.85, 1014.84, 1014.97, 1015.13, 1014.96, 1014.88, 1014.78, 1014.69, 1014.65, 1014.48, 1014.46, 1014.59, 1014.74, 1014.86, 1014.86, 1014.79, 1014.73, 1014.58, 1014.2, 1014.02, 1013.85, 1013.55, 1013.73, 1013.96, 1014.0, 1013.89, 1013.99, 1013.8, 1013.78, 1013.92, 1013.88, 1013.77, 1013.88, 1014.05, 1014.23, 1014.44, 1014.5, 1014.74, 1014.8, 1014.74, 1014.66, 1014.94, 1014.96, 1014.81, 1014.76, 1014.64, 1014.59, 1014.57, 1014.51, 1014.45, 1014.48, 1014.64, 1014.61, 1014.79, 1014.77, 1014.75, 1014.64, 1014.64, 1014.64, 1014.58, 1014.51, 1014.55, 1014.52, 1014.54, 1014.61, 1014.64, 1014.67, 1014.8, 1014.98, 1014.92, 1014.81, 1014.93, 1014.96, 1015.02, 1015.06, 1015.13, 1015.25, 1015.3, 1015.39, 1015.5, 1015.62, 1015.9, 1015.98, 1015.97, 1015.99, 1015.99, 1016.1, 1016.09, 1016.17, 1016.3, 1016.3, 1016.35, 1016.36, 1016.39, 1016.35, 1016.28, 1016.14, 1016.03, 1015.99, 1016.04, 1016.16, 1016.05, 1016.02, 1015.97, 1016.06, 1016.08, 1016.1, 1016.03, 1015.87, 1015.81, 1015.84, 1015.9, 1015.73, 1015.57, 1015.58, 1015.51, 1015.34, 1015.28, 1015.31, 1015.24, 1015.15, 1015.05, 1014.97, 1015.05, 1014.86, 1014.9, 1014.75, 1014.7, 1014.64, 1014.85, 1014.85, 1014.99, 1014.93, 1015.0, 1014.96, 1014.7, 1014.7, 1014.7, 1014.72, 1014.72, 1014.61, 1014.62, 1014.55, 1014.4, 1014.26, 1014.32, 1014.26, 1014.21, 1013.92, 1013.86, 1013.93, 1013.78, 1013.79, 1013.76, 1013.57, 1013.41, 1013.43, 1013.49, 1013.45, 1013.31, 1013.15, 1013.06, 1012.92, 1012.96, 1012.92, 1012.95, 1013.01, 1012.9, 1012.79, 1012.77, 1012.69, 1012.69, 1012.74, 1012.81, 1012.76, 1012.81, 1012.8, 1012.87, 1013.06, 1012.98, 1013.15, 1013.23, 1013.3, 1013.29, 1013.46, 1013.65, 1013.52, 1013.67, 1013.67, 1013.55, 1013.46, 1013.52, 1013.57, 1013.55, 1013.51, 1013.45, 1013.43, 1013.41, 1013.37, 1013.34, 1013.37, 1013.35, 1013.33, 1013.45, 1013.49, 1013.44, 1013.49, 1013.38, 1013.42, 1013.43, 1013.36, 1013.44, 1013.28, 1013.08, 1013.01, 1013.01, 1013.03, 1013.12, 1013.26, 1013.13, 1013.25, 1013.38, 1013.42, 1013.53, 1013.7, 1013.74, 1013.79, 1013.96, 1014.13, 1014.23, 1014.28, 1014.44, 1014.54, 1014.6, 1014.78, 1014.87, 1015.01, 1014.87, 1014.97, 1014.77, 1014.58, 1014.6, 1014.44, 1014.49, 1014.49, 1014.36, 1014.26, 1014.08, 1013.87, 1013.86, 1013.77, 1013.69, 1013.64, 1013.59, 1013.56, 1013.52, 1013.5, 1013.41, 1013.35, 1013.43, 1013.41, 1013.25, 1013.3, 1013.23, 1013.28, 1013.32, 1013.26, 1013.37, 1013.35, 1013.28, 1013.31, 1013.31, 1013.49, 1013.59, 1013.51, 1013.67, 1013.72, 1013.84, 1013.94, 1014.0, 1013.99, 1014.04, 1014.03, 1014.04, 1014.15, 1014.1, 1014.02, 1013.9, 1013.98, 1013.96, 1013.86, 1013.84, 1014.01, 1013.86, 1013.84, 1013.73, 1013.58, 1013.55, 1013.36, 1013.16, 1013.01, 1013.12, 1013.05, 1012.91, 1012.84, 1012.72, 1012.64, 1012.75, 1012.73, 1012.65, 1012.57, 1012.6, 1012.65, 1012.45, 1012.41, 1012.38, 1012.31, 1012.31, 1012.32, 1012.33, 1012.33, 1012.34, 1012.51, 1012.59, 1012.45, 1012.42, 1012.4, 1012.31, 1012.42, 1012.55, 1012.53, 1012.44, 1012.29, 1012.37, 1012.3, 1012.11, 1012.15, 1012.07, 1011.94, 1011.81, 1011.75, 1011.72, 1011.61, 1011.46, 1011.45, 1011.5, 1011.46, 1011.33, 1011.29, 1011.29, 1011.25, 1011.27, 1011.22, 1011.15, 1011.09, 1011.09, 1011.11, 1010.97, 1010.92, 1010.97, 1010.93, 1010.83, 1010.9, 1010.89, 1010.95, 1010.93, 1011.03, 1011.05, 1011.1, 1011.19, 1011.34, 1011.45, 1011.47, 1011.63, 1011.59, 1011.61, 1011.57, 1011.57, 1011.59, 1011.7, 1011.85, 1011.96, 1011.91, 1011.98, 1011.98, 1012.09, 1012.13, 1012.19, 1012.14, 1012.18, 1012.17, 1012.22, 1012.29, 1012.26, 1012.01, 1011.9, 1011.91, 1011.91, 1012.06, 1012.11, 1012.15, 1012.11, 1011.88, 1011.87, 1012.24, 1011.88, 1011.67, 1011.71, 1011.89, 1011.92, 1012.04, 1012.07, 1012.28, 1012.2, 1012.31, 1012.35, 1012.61, 1012.57, 1012.68, 1012.63, 1012.68, 1012.83, 1012.63, 1012.57, 1012.55, 1012.72, 1012.54, 1012.55, 1012.44, 1012.38, 1012.54, 1012.5, 1012.22, 1012.23, 1012.31, 1012.25, 1012.39, 1012.05, 1012.14, 1011.42, 1011.67, 1011.62, 1011.42, 1011.28, 1011.24, 1011.36, 1011.21, 1011.24, 1011.32, 1011.02, 1010.86, 1010.81, 1010.67, 1010.69, 1010.3, 1010.28, 1010.37, 1010.28, 1010.23, 1010.05, 1010.1, 1010.18, 1010.3, 1010.12, 1010.08, 1010.17, 1010.73, 1010.72, 1010.79, 1010.81, 1010.61, 1010.34, 1010.52, 1010.88, 1011.0, 1010.94, 1011.08, 1010.74, 1010.42, 1010.42, 1010.49, 1010.52, 1010.26, 1010.38, 1009.86, 1009.42, 1009.67, 1009.52, 1009.47, 1009.44, 1009.3, 1009.25, 1009.27, 1009.13, 1009.15, 1009.16, 1009.18, 1009.11, 1008.92, 1008.87, 1008.94, 1008.86, 1008.81, 1008.79, 1008.78, 1008.75, 1008.9, 1008.88, 1008.98, 1008.97, 1009.11, 1009.21, 1009.13, 1009.17, 1009.27, 1009.14, 1009.15, 1009.0, 1009.07, 1008.98, 1009.19, 1009.18, 1009.18, 1009.26, 1009.14, 1009.03, 1009.06, 1008.93, 1008.82, 1008.59, 1008.54, 1008.5, 1008.48, 1008.39, 1008.31, 1008.21, 1008.17, 1008.09, 1007.96, 1007.86, 1007.83, 1007.79, 1007.67, 1007.56, 1007.47, 1007.48, 1007.37, 1007.32, 1007.19, 1007.09, 1006.99, 1007.0, 1006.95, 1006.86, 1006.86, 1006.82, 1006.78, 1006.82, 1006.81, 1006.81, 1006.93, 1006.96, 1006.99, 1007.07, 1007.23, 1007.25, 1007.21, 1007.12, 1007.12, 1007.13, 1007.12, 1007.03, 1006.93, 1006.91, 1006.93, 1006.73, 1006.7, 1006.72, 1006.64, 1006.56, 1006.56, 1006.43, 1006.4, 1006.25, 1006.06, 1006.06, 1006.05, 1005.89, 1005.89, 1005.7, 1005.71, 1005.67, 1005.57, 1005.58, 1005.52, 1005.46, 1005.51, 1005.46, 1005.41, 1005.46, 1005.4, 1005.43, 1005.49, 1005.4, 1005.44, 1005.45, 1005.58, 1005.69, 1005.77, 1005.84, 1006.04, 1006.05, 1006.14, 1006.15, 1006.1, 1006.05, 1006.02, 1006.0, 1006.17, 1006.31, 1006.22, 1006.18, 1006.18, 1006.09, 1006.1, 1006.03, 1005.93, 1005.87, 1005.88, 1005.92, 1005.87, 1006.02, 1005.95, 1005.92, 1005.97, 1005.88, 1005.93, 1005.82, 1005.8, 1005.95, 1005.95, 1005.91, 1005.98, 1006.0, 1005.88, 1005.79, 1005.78, 1006.02, 1006.05, 1006.07, 1006.12, 1006.22, 1006.38, 1006.46, 1006.6, 1006.67, 1006.54, 1006.63, 1006.83, 1006.86, 1007.17, 1007.28, 1007.42, 1007.64, 1007.72, 1007.79, 1007.85, 1007.93, 1007.91, 1008.02, 1008.1, 1008.17, 1008.31, 1008.45, 1008.45, 1008.44, 1008.46, 1008.58, 1008.35, 1008.26, 1008.37, 1008.32, 1008.32, 1008.27, 1008.16, 1008.17, 1008.25, 1008.18, 1008.02, 1007.93, 1008.02, 1008.14, 1008.11, 1007.99, 1008.06, 1008.19, 1008.07, 1008.13, 1007.98, 1007.87, 1008.07, 1008.07, 1008.3, 1008.39, 1008.51, 1008.46, 1008.45, 1008.28, 1008.24, 1008.35, 1008.4, 1008.41, 1008.34, 1008.23, 1008.33, 1008.26, 1008.28, 1008.07, 1007.92, 1007.89, 1007.78, 1007.59, 1007.45, 1007.32, 1007.01, 1006.91, 1006.76, 1006.68, 1006.57, 1006.43, 1006.35, 1006.07, 1005.82, 1005.78, 1005.63, 1005.38, 1005.19, 1004.96, 1004.73, 1004.47, 1004.26, 1004.07, 1003.64, 1003.61, 1003.49, 1003.16, 1002.81, 1002.56, 1002.42, 1002.42, 1002.28, 1002.1, 1001.98, 1001.98, 1001.93, 1001.78, 1001.91, 1001.69, 1001.76, 1001.63, 1001.63, 1001.53, 1001.31, 1000.97, 1000.78, 1000.76, 1000.64, 1000.48, 1000.41, 1000.24, 1000.06, 1000.03, 999.89, 999.79, 999.63, 999.31, 999.14, 999.12, 998.98, 998.78, 998.64, 998.36, 998.55, 998.5, 998.57, 998.48, 998.36, 998.31, 998.21, 998.18, 998.28, 998.21, 998.2, 998.35, 998.44, 998.41, 998.51, 998.62, 998.72, 998.89, 999.04, 999.23, 999.3, 999.39, 999.59, 999.83, 1000.03, 1000.31, 1000.35, 1000.45, 1000.37, 1000.46, 1000.6, 1000.66, 1000.88, 1000.94, 1000.95, 1001.09, 1001.19, 1001.18, 1001.13, 1001.36, 1001.43, 1001.58, 1001.61, 1001.56, 1001.64, 1001.83, 1001.85, 1001.84, 1001.84, 1001.85, 1001.84, 1001.79, 1001.78, 1001.79, 1001.78, 1001.8, 1001.92, 1002.05, 1002.02, 1002.08, 1002.32, 1002.41, 1002.59, 1002.72, 1002.85, 1002.98, 1002.99, 1003.3, 1003.54, 1003.66, 1003.91, 1004.13, 1004.21, 1004.26, 1004.39, 1004.48, 1004.6, 1004.78, 1004.85, 1005.0, 1005.03, 1005.23, 1005.39, 1005.32, 1005.42, 1005.63, 1005.74, 1005.72, 1005.83, 1005.94, 1005.85, 1005.97, 1006.13, 1006.21, 1006.33, 1006.4, 1006.45, 1006.57, 1006.65, 1006.73, 1006.82, 1006.92, 1006.97, 1007.01, 1007.05, 1007.1, 1007.19, 1007.3, 1007.49, 1007.68, 1007.8, 1007.86, 1008.0, 1008.18, 1008.31, 1008.52, 1008.63, 1008.88, 1008.85, 1009.0, 1009.17, 1009.23, 1009.33, 1009.46, 1009.52, 1009.73, 1009.81, 1009.8, 1009.9, 1009.98, 1010.02, 1010.08, 1010.16, 1010.29, 1010.33, 1010.42, 1010.45, 1010.49, 1010.54, 1010.55, 1010.68, 1010.76, 1010.76, 1010.78, 1010.92, 1010.9, 1011.01, 1011.11, 1011.13, 1011.16, 1011.19, 1011.3, 1011.32, 1011.4, 1011.41, 1011.46, 1011.54, 1011.61, 1011.76, 1011.96, 1012.04, 1012.18, 1012.44, 1012.59, 1012.75, 1012.95, 1013.18, 1013.38, 1013.53, 1013.73, 1013.72, 1013.83, 1013.92, 1014.0, 1014.18, 1014.15, 1014.11, 1014.19, 1014.39, 1014.56, 1014.64, 1014.77, 1014.88, 1014.9, 1015.0, 1014.93, 1014.84, 1014.83, 1014.86, 1015.02, 1014.94, 1014.93, 1015.02, 1015.03, 1015.07, 1015.2, 1015.14, 1015.13, 1014.96, 1014.8, 1014.75, 1014.77, 1014.84, 1014.85, 1014.96, 1015.08, 1015.04, 1015.08, 1015.12, 1015.18, 1015.49, 1015.65, 1015.57, 1015.46, 1015.79, 1015.68, 1015.71, 1015.71, 1015.77, 1015.9, 1015.93, 1015.8, 1015.74, 1015.8, 1015.77, 1015.57, 1015.37, 1015.05, 1015.03, 1014.97, 1014.8, 1014.75, 1014.73, 1014.47, 1014.29, 1014.07, 1013.91, 1013.82, 1013.63, 1013.66, 1013.54, 1013.32, 1012.95, 1012.67, 1012.39, 1012.18, 1012.09, 1011.98, 1011.99, 1011.86, 1011.78, 1011.54, 1011.41, 1011.11, 1010.93, 1010.74, 1010.63, 1010.63, 1010.38, 1010.18, 1009.87, 1009.56, 1009.35, 1009.05, 1008.8, 1008.56, 1008.45, 1008.13, 1007.95, 1007.8, 1007.67, 1007.32, 1006.82, 1006.59, 1006.44, 1006.11, 1005.72, 1005.46, 1005.45, 1005.19, 1005.12, 1005.06, 1004.82, 1004.68, 1004.64, 1004.57, 1004.44, 1004.33, 1004.42, 1004.42, 1004.61, 1004.56, 1004.64, 1004.63, 1004.59, 1004.57, 1004.73, 1004.82, 1005.11, 1005.17, 1005.37, 1005.44, 1005.58, 1005.65, 1006.0, 1006.19, 1006.19, 1006.29, 1006.35, 1006.51, 1006.64, 1006.72, 1006.77, 1007.09, 1007.17, 1007.19, 1007.41, 1007.44, 1007.56, 1007.63, 1007.55, 1007.44, 1007.55, 1007.55, 1007.46, 1007.38, 1007.31, 1007.23, 1007.36, 1007.42, 1007.31, 1007.36, 1007.35, 1008.01, 1008.14, 1008.05, 1007.76, 1007.79, 1007.78, 1007.64, 1007.62, 1007.53, 1007.76, 1007.73, 1007.72, 1007.85, 1007.71, 1007.83, 1007.9, 1007.87, 1007.93, 1007.97, 1008.21, 1008.08, 1008.24, 1008.35, 1008.35, 1008.43, 1008.67, 1008.76, 1008.72, 1008.69, 1008.77, 1008.79, 1008.75, 1008.71, 1008.7, 1008.82, 1008.79, 1008.75, 1008.68, 1008.62, 1008.71, 1008.78, 1008.72, 1008.78, 1008.76, 1008.75, 1008.82, 1008.84, 1008.78, 1008.76, 1008.62, 1008.65, 1008.62, 1008.53, 1008.41, 1008.46, 1008.43, 1008.32, 1008.34, 1008.28, 1008.27, 1008.19, 1008.2, 1008.3, 1008.35, 1008.27, 1008.24, 1008.31, 1008.42, 1008.36, 1008.38, 1008.3, 1008.41, 1008.52, 1008.62, 1008.54, 1008.49, 1008.38, 1008.5, 1008.5, 1008.54, 1008.52, 1008.49, 1008.37, 1008.39, 1008.55, 1008.61, 1008.55, 1008.49, 1008.42, 1008.58, 1008.41, 1008.33, 1008.45, 1008.62, 1008.66, 1008.73, 1008.78, 1008.86, 1008.85, 1008.72, 1008.76, 1008.78, 1008.75, 1008.91, 1009.0, 1008.9, 1008.94, 1009.19, 1009.26, 1009.16, 1009.11, 1009.32, 1009.17, 1009.13, 1009.23, 1009.62, 1009.99, 1009.9, 1010.07, 1010.16, 1010.18, 1010.0, 1010.15, 1010.16, 1010.32, 1010.31, 1010.26, 1010.43, 1010.57, 1010.68, 1010.75, 1010.9, 1011.01, 1011.14, 1011.2, 1011.18, 1011.2, 1011.27, 1011.11, 1011.29, 1011.24, 1011.18, 1011.31, 1011.25, 1011.25, 1011.16, 1011.25, 1011.22, 1011.26, 1011.35, 1011.36, 1011.33, 1011.26, 1011.27, 1011.43, 1011.32, 1011.36, 1011.26, 1011.44, 1011.55, 1011.62, 1011.69, 1011.91, 1012.13, 1012.36, 1012.51, 1012.52, 1012.43, 1012.58, 1012.77, 1012.9, 1012.92, 1013.02, 1013.18, 1013.23, 1013.18, 1013.25, 1013.21, 1013.24, 1013.23, 1013.32, 1013.18, 1013.27, 1013.16, 1013.15, 1013.16, 1013.27, 1013.34, 1013.27, 1013.29, 1013.35, 1013.28, 1013.17, 1013.21, 1013.16, 1013.09, 1013.07, 1013.06, 1012.98, 1012.96, 1012.97, 1013.0, 1013.02, 1013.06, 1013.05, 1013.1, 1013.04, 1012.98, 1012.96, 1012.98, 1012.89, 1013.08, 1013.19, 1013.21, 1013.26, 1013.34, 1013.46, 1013.45, 1013.43, 1013.42, 1013.44, 1013.45, 1013.54, 1013.43, 1013.3, 1013.29, 1013.26, 1013.26, 1013.19, 1013.12, 1013.06, 1012.99, 1012.88, 1012.81, 1012.69, 1012.59, 1012.51, 1012.36, 1012.27, 1012.13, 1011.94, 1011.83, 1011.75, 1011.66, 1011.45, 1011.28, 1011.09, 1010.73, 1010.77, 1010.64, 1010.41, 1010.29, 1010.2, 1010.21, 1010.19, 1010.17, 1010.06, 1010.03, 1009.92, 1009.68, 1009.54, 1009.51, 1009.44, 1009.37, 1009.3, 1009.15, 1009.18, 1009.0, 1008.92, 1008.91, 1008.69, 1008.46, 1008.38, 1008.16, 1007.98, 1007.83, 1007.56, 1007.38, 1007.24, 1006.99, 1006.72, 1006.59, 1006.54, 1006.3, 1006.16, 1006.0, 1005.77, 1005.62, 1005.38, 1005.1, 1004.78, 1004.41, 1004.11, 1003.89, 1003.74, 1003.57, 1003.27, 1003.11, 1002.9, 1002.66, 1002.51, 1002.27, 1001.92, 1001.74, 1001.43, 1001.21, 1000.98, 1000.79, 1000.66, 1000.49, 1000.25, 1000.11, 999.95, 999.67, 999.56, 999.39, 999.07, 998.82, 998.51, 998.22, 998.13, 997.69, 997.39, 996.92, 996.46, 996.25, 996.13, 996.04, 995.7, 995.32, 994.87, 994.28, 993.73, 993.43, 993.05, 992.85, 992.55, 992.21, 991.76, 991.37, 990.98, 990.61, 990.12, 989.81, 989.34, 988.84, 988.33, 987.92, 987.41, 987.06, 986.57, 986.11, 985.74, 985.4, 984.9, 984.52, 984.16, 983.91, 983.8, 983.88, 983.9, 983.87, 983.79, 983.75, 983.88, 983.87, 983.79, 983.87, 984.02, 984.1, 984.32, 984.37, 984.38, 984.52, 984.6, 984.65, 984.66, 984.57, 984.59, 984.72, 985.06, 985.05, 985.03, 985.04, 985.1, 985.13, 985.09, 985.18, 985.1, 985.2, 985.31, 985.23, 985.47, 985.54, 985.57, 985.67, 985.63, 985.69, 985.72, 985.82, 985.94, 986.06, 986.16, 986.31, 986.65, 986.74, 986.84, 986.94, 987.0, 987.0, 987.26, 987.29, 987.23, 987.34, 987.26, 987.3, 987.37, 987.35, 987.49, 987.41, 987.4, 987.44, 987.42, 987.46, 987.23, 987.25, 987.17, 987.04, 987.01, 987.01, 986.9, 986.85, 986.91, 987.06, 986.79, 986.63, 986.44, 986.36, 986.06, 986.07, 985.72, 985.9, 985.48, 984.93, 984.68, 984.39, 984.13, 983.91, 983.82, 983.81, 983.93, 983.66, 983.76, 983.63, 983.45, 983.57, 983.37, 983.2, 982.82, 982.74, 982.58, 982.45, 982.54, 982.27, 982.08, 982.09, 982.13, 982.06, 982.02, 982.09, 982.11, 982.14, 982.42, 982.47, 982.63, 982.62, 982.6, 982.46, 982.36, 982.44, 982.63, 982.6, 982.4, 982.42, 982.11, 982.02, 981.81, 981.86, 981.68, 981.75, 981.53, 981.61, 981.52, 981.58, 981.22, 981.05, 980.61, 980.47, 980.21, 979.85, 979.53, 979.24, 978.81, 978.6, 978.27, 978.04, 977.88, 977.91, 977.48, 977.67, 977.15, 976.68, 976.44, 976.13, 975.96, 975.73, 975.97, 975.95, 975.93, 975.52, 975.46, 975.31, 975.61, 975.99, 975.94, 976.08, 975.97, 975.43, 975.64, 975.71, 975.42, 975.37, 975.26, 974.51, 974.22, 973.93, 973.82, 973.95, 973.6, 973.4, 973.41, 973.14, 972.86, 972.58, 972.66, 972.77, 972.94, 973.07, 973.19, 973.16, 973.02, 972.98, 973.32, 973.11, 973.19, 972.85, 973.03, 973.06, 973.38, 973.38, 973.25, 973.23, 973.37, 973.18, 973.31, 973.38, 973.67, 973.7, 973.91, 974.04, 974.42, 974.44, 974.51, 974.64, 974.89, 974.74, 974.71, 974.79, 974.8, 974.73, 974.86, 975.01, 975.31, 975.39, 975.43, 975.5, 975.59, 975.86, 975.95, 976.08, 976.27, 976.57, 977.01, 977.09, 977.13, 977.35, 977.49, 977.73, 977.88, 977.93, 978.01, 978.11, 978.2, 978.43, 978.52, 978.58, 978.53, 978.73, 978.79, 978.95, 979.07, 979.05, 979.19, 979.13, 979.04, 979.01, 979.16, 979.22, 979.24, 979.24, 979.32, 979.34, 979.32, 979.33, 979.39, 979.28, 979.23, 979.26, 979.32, 979.29, 979.33, 979.18, 979.3, 979.29, 979.15, 979.03, 978.99, 978.94, 978.87, 978.83, 978.76, 979.06, 979.2, 979.17, 979.28, 979.39, 979.66, 979.77, 979.96, 979.86, 980.07, 980.13, 980.19, 980.18, 980.26, 980.4, 980.5, 980.56, 980.7, 980.8, 980.9, 980.9, 980.96, 980.99, 980.99, 980.87, 980.92, 981.09, 981.29, 981.21, 981.25, 981.23, 981.32, 981.35, 981.43, 981.58, 981.59, 981.68, 981.63, 981.81, 981.94, 982.0, 982.11, 982.12, 982.43, 982.46, 982.38, 982.65, 982.72, 982.81, 983.0, 982.98, 983.14, 983.3, 983.35, 983.52, 983.71, 983.76, 983.79, 983.69, 983.85, 984.07, 984.06, 984.17, 984.23, 984.31, 984.31, 984.35, 984.42, 984.45, 984.54, 984.61, 984.62, 984.66, 984.68, 984.73, 984.8, 984.73, 984.76, 984.8, 984.7, 984.71, 984.74, 984.75, 984.83, 984.86, 984.99, 985.04, 984.99, 984.99, 985.01, 985.03, 985.14, 985.18, 985.4, 985.48, 985.57, 985.75, 985.81, 986.0, 986.07, 986.24, 986.4, 986.47, 986.67, 986.86, 987.07, 987.31, 987.43, 987.59, 987.8, 987.95, 988.05, 988.2, 988.36, 988.54, 988.81, 989.02, 989.15, 989.32, 989.42, 989.55, 989.79, 989.98, 990.17, 990.38, 990.51, 990.58]
decays= sum_values
# Create the scatter plot

pressure=pressure[300:]

decays=decays[300:]

#Bins for pressure data
pressure_bins = np.linspace(min(pressure), max(pressure), 20)  # Adjust the number of bins as needed
bin_indices = np.digitize(pressure, pressure_bins)

# Calculate mean decays and standard deviation for each bin
mean_decays = [np.mean([decays[i] for i in range(len(decays)) if bin_indices[i] == bin_num]) for bin_num in range(1, len(pressure_bins))]
std_decays = [np.std([decays[i] for i in range(len(decays)) if bin_indices[i] == bin_num]) for bin_num in range(1, len(pressure_bins))]

plt.figure(figsize=(7, 3))

# Create the scatter plot
#scatter = plt.scatter(pressure, decays, color='blue', label='Data')
mean_scatter = plt.scatter(pressure_bins[:-1], mean_decays, color='black', label='Mean Decays in Bins')
plt.errorbar(pressure_bins[:-1], mean_decays, yerr=std_decays, fmt='o', color='black', ecolor='black', elinewidth=1, capsize=3, capthick=1)

# Plot the trendline using linear regression
coefficients = np.polyfit(pressure_bins[:-1], mean_decays, 1)
trendline = np.polyval(coefficients, pressure_bins[:-1])
line = plt.plot(pressure_bins[:-1], trendline, color='red', label=f'Trendline: y = {coefficients[0]:.2f}x + {coefficients[1]:.2f}')

plt.xlabel('Pressure (hPa)')
plt.ylabel('Muon Counts [Arb. Units]')
#plt.title('Muon Counts vs Pressure for 20 bin intervals')
plt.grid(True)

# Add the equation of the trendline to the legend
plt.legend([mean_scatter, line[0]], ['Mean Counts', f'Trendline: y = {coefficients[0]:.2f}x + {coefficients[1]:.2f}'])

plt.show()

# Bins for pressure data
pressure_bins = np.linspace(min(pressure), max(pressure), 20)
bin_indices = np.digitize(pressure, pressure_bins)

# Calculate mean residuals for each bin
mean_residuals = [np.mean([residuals[i] for i in range(len(residuals)) if bin_indices[i] == bin_num]) for bin_num in range(1, len(pressure_bins))]
std_residuals = [np.std([residuals[i] for i in range(len(residuals)) if bin_indices[i] == bin_num]) for bin_num in range(1, len(pressure_bins))]

plt.figure(figsize=(7, 3))

# Create the scatter plot for mean residuals only
mean_residual_scatter = plt.scatter(pressure_bins[:-1], mean_residuals, color='black', label='Mean Residuals in Bins')
plt.errorbar(pressure_bins[:-1], mean_residuals, yerr=std_residuals, fmt='o', color='black', ecolor='black', elinewidth=1, capsize=3, capthick=1)

# Plot the zero residuals line in red
zero_residual_line = plt.axhline(0, color='red', linestyle='--', label='Zero Residuals')

plt.xlabel('Pressure (hPa)')
plt.ylabel('Residuals')
plt.title('Binned Residuals Plot')
plt.grid(True)

plt.legend([mean_residual_scatter, zero_residual_line], ['Mean Residuals', 'Zero Residuals'])

plt.show()
